原文链接：[《第十九篇：提高SOUI应用程序渲染性能的三种武器》](http://www.cnblogs.com/setoutsoft/p/4193791.html)

SOUI是一套100%开源的基于DirectUI的客户端开发框架。

基于DirectUI设计的UI虽然UI呈现的效果可以很炫，但是相对于传统的win32应用程序中每个控件一个窗口句柄的形式，渲染效率是一个很重要的问题。

在SOUI系统中提供了三种武器可以用来提高渲染效率：

### 第一种武器：选择更高效的渲染引擎
渲染引擎提供文字，几何图形，图像的在缓存上的绘制功能。在SOUI系统中，渲染引擎是一个独立的模块，它不依赖于SOUI系统中的其它模块。

在SOUI系统中已经内置了基于skia及GDI两种框架的渲染模块(skia即在google的chrome及android中使用的渲染引擎）。直观的比较采用两种不同渲染引擎demo中动画的流畅度就可以知道基于skia的渲染引擎速度要比基于GDI的快不少。（GDI慢的原因可能是因为在GDI原生不支持alpha通道，而在实现的过程中采用alphablend模拟alpha时导致性能损失）

如果用户觉得内置的渲染引擎还是不足以满足自己的需求，还可以选择自己实现新的渲染引擎，如基于`Direct2D, cairo, agg`等渲染引擎。

### 第二种武器：绘制缓存
一个窗口中的呈现的内容很多时候都是固定的，特别是当窗口大小不变的时候。窗口中呈现的内容可能是经过复杂计算获得的（如图像的九宫格切分，拉伸等），如果每次刷新都重新计算显示渲染效率可能下降，特别是当窗口还比较大的时候。

为了解决这个问题，在SOUI系统中，我们为SWindow提供了一个cache属性，`cache=“1”`时，在窗口中绘制的内容会被自动缓存，下次刷新时，自动从缓存中提取数据，从而大大加速绘制过程。

### 第三种武器：非背景混合技术
DirectUI炫酷的效果是依赖于各窗口之间的相互混合实现的（alphablend)，但是有些时候一个窗口它可能有自己固定的背景，或者前景完全覆盖窗口而不需要背景。如果这个窗口刷新非常频繁，那么每次刷新都先通知各级父窗口刷新获得背景再做混合将是很大的性能损失（如视频播放窗口）。

为了解决这个问题，在SOUI系统中(ver:1.3.0.1)为SWindow实现了一个新的属性：`bkgndBlend`，该属性默认为“1”，代表刷新时使用背景混合。如果该属性为“0”，则该窗口刷新的时候直接刷新自己，而不请求父窗口刷新背景，最终提高UI的渲染效率。 